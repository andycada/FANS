BEC1 <- read_excel("Data/BEC1.xlsx")
BEC2 <- read_excel("Data/BEC2.xlsx")
BEC3 <- read_excel("Data/BEC3.xlsx")
BEC4 <- read_excel("Data/BEC4.xlsx")
BEM1 <- read_excel("Data/BEM1.xlsx")
BEM2 <- read_excel("Data/BEM2.xlsx")
BEM3 <- read_excel("Data/BEM3.xlsx")
BEM4 <- read_excel("Data/BEM4.xlsx")
BEM5 <- read_excel("Data/BEM5.xlsx")
#B fondo mejillon
BFM1 <- read_excel("Data/BFM1.xlsx")
BFM2 <- read_excel("Data/BFM2.xlsx")
BFM3 <- read_excel("Data/BFM3.xlsx")
PPM1 <- read_excel("Data/PPM1.xlsx")
PPM2 <- read_excel("Data/PPM2.xlsx")
library(mgcv)
layout(matrix(c(1:6), 2, 3))
layout(1)
model0 <- gam(STX ~ s(Days_T), data = BEC1, method = "REML")
plot.gam(model0,xlab= "Detoxification days", residuals=T,pch=1,all.terms=T,seWithMean=T, main= "BBE magellan mussel")
summary(model0) #R-sq.(adj) =  0.699   Deviance explained = 76% # no lo inclui en el grafico general
gam.check(model0)
concurvity(model0, full = TRUE)
model1 <- gam(STX ~ s(Days_T), data = BEC2, method = "REML")
plot.gam(model1,xlab= "Detoxification days",residuals=T,pch=1,all.terms=T,seWithMean=T)
summary(model1)  #R-sq.(adj) =  0.222   Deviance explained = 30.8% # no lo inclui en el grafico general
gam.check(model1)
model2 <- gam(STX ~ s(Days_T), data = BEC3, method = "REML")
plot.gam(model2, xlab= "Detoxification days",residuals=T,pch=1,all.terms=T,seWithMean=T, main= "BBE magellan mussel")
summary(model2)  # R-sq.(adj) =  0.786   Deviance explained = 84.7%
gam.check(model2) # esta curva va queriendo, mejor ajuste y se ven mejor los residuales
model3 <- gam(STX ~ s(Days_T), data = BEM1, method = "REML")
plot.gam(model3,xlab= "Detoxification days",residuals=T,pch=1,all.terms=T,seWithMean=T, main= "BBE blue mussel")
summary(model3)  #R-sq.(adj) =  0.933   Deviance explained =   95%
gam.check(model3)  #residuales ok
model4 <- gam(STX ~ s(Days_T), data = BEM2, method = "REML")
plot.gam(model4,xlab= "Detoxification days",residuals=T,pch=1,all.terms=T,seWithMean=T, main= "BBE blue mussel")
summary(model4)  #R-sq.(adj) =   0.29   Deviance explained = 39.6%, Days T no sig # no lo inclui en el grafico general
gam.check(model4)
model5 <- gam(STX ~ s(Days_T), data = BEM3, method = "REML")
plot.gam(model5,xlab= "Detoxification days",residuals=T,pch=1,all.terms=T,seWithMean=T, main= "BBE blue mussel")
summary(model5)  #R-sq.(adj) =  0.811   Deviance explained = 87.8%
gam.check(model5)
model6 <- gam(STX ~ s(Days_T), data = BEM4, method = "REML")
plot.gam(model6,xlab= "Detoxification days", residuals=T,pch=1,all.terms=T,seWithMean=T, main= "BBE blue mussel")
summary(model6)  #R-sq.(adj) =  0.804   Deviance explained =   88%
gam.check(model6)
model7 <- gam(STX ~ s(Days_T), data = BEM5, method = "REML")
plot.gam(model7,xlab= "Detoxification days", residuals=T,pch=1,all.terms=T,seWithMean=T, main= "BBE blue mussel")
summary(model7)
gam.check(model7) ### no lo hace pocas observaciones
model7 <- gam(STX ~ s(Days_T), data = BFM1, method = "REML")
plot.gam(model7,xlab= "Detoxification days",residuals=T,pch=1,all.terms=T,seWithMean=T, main= "BBF blue mussel")
summary(model7)  #-sq.(adj) =  0.743   Deviance explained = 82.5%
gam.check(model7) # algo ajusta hay q arreglar los residuales
model8 <- gam(STX ~ s(Days_T), data = PPM1, method = "REML")
plot.gam(model8,xlab= "Detoxification days",residuals=T,pch=1,all.terms=T,seWithMean=T, main= "PP blue mussel")
summary(model8)  #R-sq.(adj) =  0.791   Deviance explained = 85.4%
gam.check(model8)
model8 <- gam(STX ~ s(Days_T), data = PPM2, method = "REML")
plot.gam(model8,residuals=T,pch=1,all.terms=T,seWithMean=T)
summary(model8)
gam.check(model8) #pocas observaciones no lo hace
library(readxl)
DETOX2 <- read_excel("Data/DETOX-filtrado.xlsx")
names(DETOX2)
str(DETOX2)
model0 <- gam(STX ~ s(Days), data = DETOX2, method = "REML")
plot.gam(model0,residuals=T,pch=1,all.terms=T,seWithMean=T)
summary(model0)  #
gam.check(model0)
library(mgcv)
DETOX2$area<-as.factor(DETOX2$area)
DETOX2$organism<-as.factor(DETOX2$organism)
class(DETOX2$area)
class(DETOX2$organism)
class(DETOX2$Date)
layout(1)
model1 <- gam(STX ~ s(Days) + area + organism, data = DETOX2,family=Gamma, method = "REML")
plot.gam(model1,xlab= "Detoxification days",residuals=T,pch=1,all.terms=T,seWithMean=T, pages=1)
summary(model1)  #R-sq.(adj) =   0.25   Deviance explained = 43.3% ################
gam.check(model1, pages=1)
model2 <- gam(STX ~ s(Days,  by = area), data = DETOX2,family=Gamma, method = "REML")
plot.gam(model2,xlab= "Detoxification days",residuals=T,pch=1,all.terms=T,seWithMean=T, pages=1)
summary(model2)  #R-sq.(adj) =   0.259   Deviance explained = 46.2%, sig BBE y PP pero los graficos no se ve nada
gam.check(model2, pages=1)
model3 <- gam(STX ~ s(Days,  by = organism), data = DETOX2,family=Gamma, method = "REML")
plot.gam(model3,xlab= "Detoxification days",residuals=T,pch=1,all.terms=T,seWithMean=T, pages=1)
summary(model3)  #R-sq.(adj) =   0.191   Deviance explained = 39.3%, sig cholga y meji pero los graficos no dan nada
gam.check(model3, pages=1)
model4 <- gam(STX ~ s(Days,  by = area) + organism, data = DETOX2,family=Gamma (link="log"), method = "REML")
plot.gam(model4,xlab= "Detoxification days",residuals=T,pch=500,all.terms=T,seWithMean=T, pages=1)
summary(model4)  #R--sq.(adj) =  0.202   Deviance explained = 45.9%, todos sig y lindos graficos ###########
gam.check(model4, pages=1)
model5 <- gam(STX ~ s(Days,  by = organism) + area, data = DETOX2,family=Gamma, method = "REML")
plot.gam(model5,xlab= "Detoxification days",residuals=T,pch=1,all.terms=T,seWithMean=T, pages=1)
summary(model5)  #R--sq.(adj) =   0.26   Deviance explained = 44.1%, sig cholga y meji pero los graficos no dan nada
gam.check(model5, pages=1)
#transformo datos a log
model6 <- gam(STX ~ s(Days) + area + organism, data = DETOX2,family=Gamma (link="log"), method = "REML")
plot.gam(model6,residuals=T,pch=1,all.terms=T,seWithMean=T, pages=1)
summary(model6)  #R-sq.(adj) =  0.162   Deviance explained = 44.7%
gam.check(model6)
AIC(model0,model1,model2,model3,model4,model5,model6) # modelo 6 y 4 los mejores
library(gamm4)
---
title: "ToxicAlgae"
author: "Leonardo A. Saravia"
---
# Cargo archivo de Eventos toxicos (2005-2017)
# Dias: duracion de la veda, T desde q el mejillon supera los 80 µg STX/100 g tejido, hasta que tiene valores por debajo de ese umbral
# Conc: STXmax concentracion maxima de toxina (STXmax) alcanzada duante el evento toxico
# area: BBE (Bahia Brown Entrada), BBF (Bahia Brown Fondo), BBB (BB Bajo), PP (Punta Parana)
# organism: Mejillon (M. edulis), Cholga  (A. ater)
library(readxl)
title: "ToxicAlgae"
author: "Leonardo A. Saravia"
library(readxl)
require(tidyverse)
theme_set(theme_bw())
require(drc)
cor <- read_excel("Data/DataTot.xlsx")
ggplot(cor, aes(x = Dias, y = Conc) ) +
geom_line() + theme_bw() + geom_smooth(se=FALSE)
#
# f(x) = d / (1+exp(b(x - e)))
#
model1 <- drm(Conc ~ Dias, fct=lgaussian() , data = cor)
plot(model1)
summary(model1)
model2 <- drm(Conc ~ Dias, fct=multi2() , data = cor)
plot(model2)
AIC(model1,model2)
library(mgcv)
require(gratia)
library(draw)
gam_mod <- gam(Conc ~ s(Dias,k=20), data = cor,family=Gamma(link="log"), method="REML")
# Plot the results
summary(gam_mod)
draw(gam_mod,residuals=T) #dibuja el GAMs y los puntos son los residuales
appraise(gam_mod) # chequea el modelo, residuales, etc
cor <- add_fitted(cor,gam_mod,value="pred")
ggplot(cor) + geom_point(aes(x = Dias, y = Conc), alpha = 0.6) +
geom_line(aes(x=Dias, y = pred), color = "red") + scale_y_log10() # dibuja los datos y le agrega la curva en rojo que predice el modelo
gam_mod1 <- gam(Conc ~ s(Dias,k=20), data = cor, method="REML")
summary(gam_mod1)
draw(gam_mod1,residuals=TRUE)
appraise(gam_mod1)
cor <- add_fitted(cor,gam_mod1,value="pred1")
ggplot(cor) + geom_point(aes(x = Dias, y = Conc), alpha = 0.6) +
geom_line(aes(x=Dias, y = pred), color = "red") +
geom_line(aes(x=Dias, y = pred1), color = "brown") + scale_y_log10()
AIC(gam_mod,gam_mod1)
$$f(t) = a \exp \left(- \frac{|t-c|}{b} \right)$$
Donde $a$ mide la altura del pico, $b$ la pendiente y $c$ la ubicación
require(propagate)
cor[which.max(cor$Conc),]
#
# Laplace
#
nonlin <- function(t, a, b, c) { a * (exp(-(abs(t-c) / b))) }
nlsfit1 <- nls(Conc ~ nonlin(Dias, a, b, c), data=cor, start=list(a=55, b=2, c=75),algorithm = "port")
summary(nlsfit1)
nlsfit1 <- nls(Conc ~ nonlin(Dias, a, b, c), data=cor, start=list(a=3500, b=5, c=75),algorithm = "port")
pred <- predict(nlsfit1, newdata = data.frame(Dias = cor$Dias))
#pred$summary
df <- cbind(cor, pred)
ggplot(df) + geom_point(aes(x = Dias, y = Conc), alpha = 0.6) +
geom_line(aes(x=Dias, y = pred), color = "red") + theme_bw()
#
# Double exponencial con diferentes pendientes
#
nonlin <- function(t, a, bl, br, c,d) {
ifelse(t < c,d + (a * exp((t-c) / bl)), d +( a * exp(-(t-c) / br)))
}
nlsfit2 <- nls(Conc ~ nonlin(Dias, a, bl, br, c,d), data=cor, start=list(a=3000, bl=3, br=2, c=75,d=100),algorithm = "port")
nlsfit2
AIC(nlsfit1,nlsfit2)
pred <- predict(nlsfit2, newdata = data.frame(Dias = 0:max(cor$Dias)))
df2 <- data.frame(Dias = 0:max(cor$Dias), pred=pred)
ggplot(cor) + geom_point(aes(x = Dias, y = Conc), alpha = 0.6) +
geom_line(data=df2,aes(x=Dias, y = pred), color = "red") + scale_y_log10()
#
# Tranformando el tiempo a logaritmo
#
nonlin <- function(t, a, b, c) { a * (exp(-(abs(log(t)-c) / b))) }
nlsfit <- nls(Conc ~ nonlin(Dias, a, b, c), data=cor, start=list(a=2500, b=1, c=4))
AIC(nlsfit1,nlsfit2,nlsfit)
pred <- predict(nlsfit, newdata = data.frame(Dias = cor$Dias))
df3 <- cbind(cor, pred)
ggplot(df3) + geom_point(aes(x = Dias, y = Conc), alpha = 0.6) +
geom_line(aes(x=Dias, y = pred), color = "red") + theme_bw()
#
# Usando una LogNormal
#
nonlin <- function(t, a, b, c) { a * (exp(-(log(t)-c)^2 / b)) }
nlsfit4 <- nls(Conc ~ nonlin(Dias, a, b, c), data=cor, start=list(a=3500, b=1.2, c=4.1),algorithm = "port")
AIC(nlsfit1,nlsfit2,nlsfit,nlsfit4)
pred <- predict(nlsfit4, newdata = data.frame(Dias = cor$Dias))
df4 <- cbind(cor, pred)
ggplot(df4) + geom_point(aes(x = Dias, y = Conc), alpha = 0.6) +
geom_line(aes(x=Dias, y = pred), color = "red")
#
# Gumbel distribution
#
nonlin <- function(t, a, b, c) { (a/b) * exp( -(t-c)/b - exp(-(t-c)/b) ) }
nlsfit5 <- nls(Conc ~ nonlin(Dias, a, b, c), data=cor, start=list(a=3500, b=50, c=75),algorithm = "port")
AIC(nlsfit1,nlsfit2,nlsfit,nlsfit4,nlsfit5)
pred <- predict(nlsfit5, newdata = data.frame(Dias = 0:max(cor$Dias)))
df4 <- data.frame(Dias = 0:max(cor$Dias), pred=pred)
ggplot(cor) + geom_point(aes(x = Dias, y = Conc), alpha = 0.6) +
geom_line(data=df4,aes(x=Dias, y = pred), color = "red")
#
library(readxl)
data <- read_excel("Data/totalRsinbajo.xlsx")
names(data)
str(data)
library(sciplot)
bargraph.CI(Area,STX, data = data, ylim= c(0, 200), ylab = "µg STX eq/100 g tissue", xlab = "Season", col = "steelblue4")
bargraph.CI(season,STX, data = data, ylim= c(0, 700), ylab = "µg STX eq/100 g tissue", xlab = "Season", col = "steelblue4")
# ANOVAS
a1 <- aov(STX ~ Area, data = data, na.action=na.fail)
summary(a1)
TukeyHSD(a1,"Area") # dif sig en el area (BBE> PP> BBF)
# analisis de residuales
layout(matrix(c(1:6), 2, 3))
plot(a1, 1:6) # no parece mejorar cn transformacion log
layout(1)
a2 <- aov(STX ~ season, data = data, na.action=na.fail)
summary(a2)
TukeyHSD(a2,"season") # dif sig en la estacion  (summer> autumn> spring> winter)
# analisis de residuales
layout(matrix(c(1:6), 2, 3))
plot(a2, 1:6) # no parece mejorar cn transformacion log
layout(1)
library(sciplot)
bargraph.CI(season, STX, Area, data = data,  xlab = "Season", ylab = "µg STX eq/100 g tissue", legend = TRUE)
bargraph.CI(Area, STX, season, data = data,  xlab = "Area", ylab = "µg STX eq/100 g tissue", legend = TRUE)
a3 <- aov(log(STX +1) ~ Area*season, data = data)
summary(a3)
TukeyHSD(a3,"Area:season")
layout(matrix(c(1:6), 2, 3))
plot(a3, 1:6)
layout(1)
bargraph.CI(Organism, STX, data = data,  xlab = "Season", ylab = "µg STX eq/100 g tissue", legend = TRUE)
a4 <- aov(STX  ~ Organism, data = data)
summary(a4) # no hay dif en los niveles de STX segun el organismo PERO EL N ES MUY DIFERENTE
# residuales
layout(matrix(c(1:6), 2, 3))
plot(a4, 1:6) # residuales horribles
layout(1)
data <- read_excel("Data/totalR.xlsx")
names(data)
str(data)
library(sciplot)
bargraph.CI(Area,STX, data = data, ylim= c(0, 200), ylab = "µg STX eq/100 g tissue", xlab = "Area")
a1 <- aov(STX ~ Area, data = data, na.action=na.fail)
summary(a1)
TukeyHSD(a1,"Area") # STX es sig diferente en cada area de muestreo (BBE>PP>BBF>BBB)
# residuales
layout(matrix(c(1:6), 2, 3))
plot(a1, 1:6)
layout(1)
bargraph.CI(season,STX, data = data, ylim= c(0, 400), ylab = "µg STX eq/100 g tissue", xlab = "Season")
a2 <- aov(log(STX + 1) ~ season, data = data, na.action=na.fail)
summary(a2)
TukeyHSD(a2,"season") # STX es sig diferente en cada estacion del anio (summer> autumn> spring> winter)
#residuales
layout(matrix(c(1:6), 2, 3))
plot(a2, 1:6)
layout(1)
library(sciplot)
bargraph.CI(season, STX, Area, data = data,  xlab = "Season", ylab = "µg STX eq/100 g tissue", col = c("steelblue1", "steelblue4"), legend = TRUE)
bargraph.CI(Area, STX, season, data = data, ylim =c(0,800), xlab = "Area", ylab = "µg STX eq/100 g tissue", legend = TRUE, x.leg=0, y.leg=850, ncol=1)
a3 <- aov(STX ~ Area*season, data = data)
summary(a3)
TukeyHSD(a3,"Area:season")
# residuales
layout(matrix(c(1:6), 2, 3))
plot(a3, 1:6)
layout(1)
bargraph.CI(Organism,STX, data = data, ylab = "µg STX eq/100 g tissue", xlab = "Season")
a4 <- aov(STX ~ Organism, data = data)
summary(a4) # no hay df en la toxicidad en relacion al organismo
# residuales
layout(matrix(c(1:6), 2, 3))
plot(a4, 1:6)
layout(1)
bargraph.CI(season, STX, Organism, data = data,  xlab = "Season", ylab = "µg STX eq/100 g tissue", legend = TRUE, x.leg=0.5, y.leg=500, ncol=1)
bargraph.CI(Area, STX, Organismo, data = data,  xlab = "Area", ylab = "µg STX eq/100 g tissue", legend = TRUE)
M <- read_excel("Data/MejillonR.xlsx")
str(M)
bargraph.CI(Area, STX, data = M, xlab = "Area", ylab = "µg STX eq/100 g tissue", legend = TRUE)
a6 <- aov(STX ~ Area, data = M) # niveles de STX son sifnificativamente diferentes enlas 3 zonas q tienen mejillon
summary(a6)
TukeyHSD(a6,"Area") #dif sig en los mejillones (BBE> PP> BBF)
layout(matrix(c(1:6), 2, 3))
plot(a6, 1:6)
layout(1)
C <- read_excel("Data/cholgaR.xlsx")
str(C)
bargraph.CI(Area, STX, data = C,  xlab = "Area", ylab = "µg STX eq/100 g tissue", legend = TRUE)
a7 <- aov(STX ~ Area, data = C) # niveles de STX son sig diferentes en las 2 zonas q tienen cholga (BBE> BBB)
summary(a7)
layout(matrix(c(1:6), 2, 3))
plot(a7, 1:6)
layout(1)
BBE <- read_excel("Data/BBE-R.xlsx")
str(BBE)
bargraph.CI(organism, STX, data = BBE,  xlab = "Organism", ylab = "µg STX eq/100 g tissue", legend = TRUE)
a8 <- aov(STX ~ organism, data = BBE)
summary(a8) # no hay dif en los valores de STX en el producto en la BBE
layout(matrix(c(1:6), 2, 3))
plot(a8, 1:6)
layout(1)
# winter
W <- read_excel("Data/winterR.xlsx")
str(W)
bargraph.CI(organism, STX, data = W, xlab = "Winter", ylab = "µg STX eq/100 g tissue", legend = TRUE)
a0 <- aov(STX ~ organism, data = W) #  significativos
summary(a0)
a0 <- aov(log (STX + 1) ~ organism, data = W) #  significativos
summary(a0)
layout(matrix(c(1:6), 2, 3)) # residuales horribles
plot(a0, 1:6)
layout(1)
# autumn
A <- read_excel("Data/autumnR.xlsx")
str(A)
bargraph.CI(organism, STX, data = A, xlab = "Autumn", ylab = "µg STX eq/100 g tissue", legend = TRUE)
a1 <- aov(STX ~ organism, data = A) #  significativos
summary(a1)
layout(matrix(c(1:6), 2, 3)) # residuales horribles
plot(a1, 1:6)
layout(1)
S <- read_excel("Data/summerR.xlsx")
str(S)
bargraph.CI(organism, STX, data = S, xlab = "Summer", ylab = "µg STX eq/100 g tissue", legend = TRUE)
a2 <- aov(STX  ~ organism, data = S) # no significativo
summary(a2)
layout(matrix(c(1:6), 2, 3))
plot(a2, 1:6)
layout(1)
SP <- read_excel("Data/springR.xlsx")
str(SP)
bargraph.CI(organism, STX, data = SP, xlab = "Spring", ylab = "µg STX eq/100 g tissue", legend = TRUE)
a3 <- aov(STX ~ organism, data = SP) # no significativo
summary(a3)
layout(matrix(c(1:6), 2, 3))
plot(a3, 1:6)
layout(1)
# dif entre medias anuales ---------------------------------#
bargraph.CI(Year, STX, data = data,  xlab = "Year", ylab = "µg STX eq/100 g tissue", legend = TRUE)
a6 <- aov(STX  ~ Year, data = data) #  significativos
summary(a6)
TukeyHSD(a6,"Year")
layout(matrix(c(1:6), 2, 3))
plot(a6, 1:6)
layout(1)
# dif entre medias anuales por area
bargraph.CI(Year, STX, Area, data = data,  xlab = "Year", ylab = "µg STX eq/100 g tissue", legend = TRUE, x.leg=0, y.leg=700)
a7 <- aov(STX ~ Year*Area, data = data) # los 3 significativos
summary(a7)
TukeyHSD(a7,"Year:Area")
layout(matrix(c(1:6), 2, 3))
plot(a7, 1:6)
layout(1)
library(readxl)
data2 <- read_excel("Data/eventos toxicos y duracion.xlsx")
names(data2)
bargraph.CI(Duration,STXmax,Organism, data = data2,  ylab = "µg STX eq/100 g tissue", xlab = "Days", col = "steelblue4")
a8 <- aov(log(Duration) ~ Organism, data = data2, na.action=na.fail)
summary(a8) # la duracion del evento toxico depende del organismo? no dif sig en la duracion del evento toxico segun el organismo
layout(matrix(c(1:6), 2, 3)) # residuales parecen mejorar cn el log
plot(a8, 1:6)
bargraph.CI(Duration,Organism, data = data2,  ylab = "µg STX eq/100 g tissue", xlab = "Days", col = "steelblue4")
bargraph.CI(Duration,STXmax,Organism, data = data2,  ylab = "µg STX eq/100 g tissue", xlab = "Days", col = "steelblue4")
bargraph.CI(Duration,STXmax,Organism, data = data2, ylim=1000, ylab = "µg STX eq/100 g tissue", xlab = "Days", col = "steelblue4")
bargraph.CI(Duration,STXmax,Organism, data = data2, ylim=600, ylab = "µg STX eq/100 g tissue", xlab = "Days", col = "steelblue4")
bargraph.CI(Duration,STXmax,Organism, data = data2, ylab = "µg STX eq/100 g tissue", xlab = "Days", col = "steelblue4")
bargraph.CI(Duration,STXmax,Season, data = data2,  ylab = "µg STX eq/100 g tissue", xlab = "Days", col = "steelblue4")
bargraph.CI(Duration,STXmax,Organism, data = data2, ylab = "µg STX eq/100 g tissue", xlab = "Days", col = "steelblue4", legend = TRUE)
bargraph.CI(Duration,STXmax,Organism, data = data2, ylab = "µg STX eq/100 g tissue", xlab = "Days", legend = TRUE)
bargraph.CI(Duration,STXmax,Organism, data = data2, ylab = "µg STX eq/100 g tissue", xlab = "Days", legend = TRUE, xleg=0, yleg=400)
bargraph.CI(Duration,STXmax,Organism, data = data2, ylab = "µg STX eq/100 g tissue", xlab = "Days", legend = TRUE, x.leg=0, y.leg=400)
bargraph.CI(Duration,STXmax,Organism, data = data2, ylab = "µg STX eq/100 g tissue", xlab = "Days", legend = TRUE, x.leg=0, y.leg=600)
bargraph.CI(Duration,STXmax,Organism, data = data2, ylab = "µg STX eq/100 g tissue", xlab = "Days", legend = TRUE, x.leg=0, y.leg=500)
bargraph.CI(Duration,STXmax,Organism, data = data2, y.lim=800, ylab = "µg STX eq/100 g tissue", xlab = "Days", legend = TRUE, x.leg=0, y.leg=500)
bargraph.CI(Duration,STXmax,Organism, data = data2, ylim=800, ylab = "µg STX eq/100 g tissue", xlab = "Days", legend = TRUE, x.leg=0, y.leg=500)
bargraph.CI(Duration,STXmax,Organism, data = data2, ylab = "µg STX eq/100 g tissue", xlab = "Days", legend = TRUE, x.leg=0, y.leg=500)
bargraph.CI(Duration,STXmax,Season, data = data2,  ylab = "µg STX eq/100 g tissue", xlab = "Days", col = "steelblue4")
bargraph.CI(Duration,STXmax,Season, data = data2,  ylab = "µg STX eq/100 g tissue", xlab = "Days", legend=T, x.leg=0, y.leg=500)
bargraph.CI(Duration,STXmax,Season, data = data2, xlim=300, ylim= 600, ylab = "µg STX eq/100 g tissue", xlab = "Days", legend=T, x.leg=0, y.leg=500)
bargraph.CI(Duration,STXmax,Season, data = data2, ylim= 600, ylab = "µg STX eq/100 g tissue", xlab = "Days", legend=T, x.leg=0, y.leg=500)
bargraph.CI(Duration,STXmax,Season, data = data2, ylab = "µg STX eq/100 g tissue", xlab = "Days", ylim=600, legend=T, x.leg=0, y.leg=500)
library(readxl)
data2 <- read_excel("Data/eventos toxicos y duracion.xlsx")
names(data2)
bargraph.CI(Duration,STXmax,Season, data = data2, ylab = "µg STX eq/100 g tissue", xlab = "Days", legend=T, x.leg=0, y.leg=500)
bargraph.CI(Duration,STXmax,Organism, data = data2, ylab = "µg STX eq/100 g tissue", xlab = "Days", legend = TRUE, x.leg=0, y.leg=500)
View(data2)
bargraph.CI(Duration,STXmax,Season, data = data2, ylab = "µg STX eq/100 g tissue", xlab = "Days", legend=T, x.leg=0, y.leg=500)
bargraph.CI(Duration,STXmax,Area, data = data2, ylab = "µg STX eq/100 g tissue", xlab = "Days", legend=T, x.leg=0, y.leg=500)
bargraph.CI(Duration,STXmax,Area, data = data2, ylab = "µg STX eq/100 g tissue", xlab = "Days", legend=T, x.leg=0, y.leg=600)
# residuales
layout(matrix(c(1:6), 2, 3)) #residuales horribles incluso cn transformacion
plot(a4, 1:6)
a4 <- aov(STX ~ Organism, data = data)
library(readxl)
data <- read_excel("Data/totalRsinbajo.xlsx")
names(data)
str(data)
library(sciplot)
bargraph.CI(Area,STX, data = data, ylim= c(0, 200), ylab = "µg STX eq/100 g tissue", xlab = "Season", col = "steelblue4")
bargraph.CI(season,STX, data = data, ylim= c(0, 700), ylab = "µg STX eq/100 g tissue", xlab = "Season", col = "steelblue4")
# ANOVAS
a1 <- aov(STX ~ Area, data = data, na.action=na.fail)
summary(a1)
TukeyHSD(a1,"Area") # dif sig en el area (BBE> PP> BBF)
# analisis de residuales
layout(matrix(c(1:6), 2, 3))
plot(a1, 1:6) # no parece mejorar cn transformacion log
layout(1)
install.packages("AED")
library(readxl)
data <- read_excel("Data/totalRsinbajo.xlsx")
names(data)
str(data)
library(sciplot)
bargraph.CI(Area,STX, data = data, ylim= c(0, 200), ylab = "µg STX eq/100 g tissue", xlab = "Season", col = "steelblue4")
bargraph.CI(season,STX, data = data, ylim= c(0, 700), ylab = "µg STX eq/100 g tissue", xlab = "Season", col = "steelblue4")
# ANOVAS
a1 <- aov(STX ~ Area, data = data, na.action=na.fail)
summary(a1)
TukeyHSD(a1,"Area") # dif sig en el area (BBE> PP> BBF)
# analisis de residuales
layout(matrix(c(1:6), 2, 3))
plot(a1, 1:6) # no parece mejorar cn transformacion log
layout(1)
k1<-kruskal.test(STX ~ Area, data = data, na.action=na.fail)
k1 #p-value < 2.2e-16
a2 <- aov(STX ~ season, data = data, na.action=na.fail)
summary(a2)
TukeyHSD(a2,"season") # dif sig en la estacion  (summer> autumn> spring> winter)
# analisis de residuales
layout(matrix(c(1:6), 2, 3))
plot(a2, 1:6) # no parece mejorar cn transformacion log
layout(1)
k2<-kruskal.test(STX ~ season, data = data, na.action=na.fail)
k2 #p-value < 2.2e-16
library(sciplot)
bargraph.CI(season, STX, Area, data = data,  xlab = "Season", ylab = "µg STX eq/100 g tissue", legend = TRUE)
bargraph.CI(Area, STX, season, data = data,  xlab = "Area", ylab = "µg STX eq/100 g tissue", legend = TRUE)
a3 <- aov(log(STX + 1) ~ Area*season, data = data)
summary(a3)
TukeyHSD(a3,"Area:season")
layout(matrix(c(1:6), 2, 3))
plot(a3, 1:6)
layout(1)
k3<-kruskal.test(STX ~ Area*season, data = data, na.action=na.fail)
k3<-kruskal.test(STX ~ Area + season, data = data, na.action=na.fail)
k3<-kruskal.test(STX ~ Area : season, data = data, na.action=na.fail)
names(Data)
data <- read_excel("Data/totalR.xlsx")
names(Data)
data <- read_excel("Data/totalR.xlsx")
names(Data)
data <- read_excel("Data/totalR.xlsx")
names(Data)
library(readxl)
data <- read_excel("Data/totalR.xlsx")
names(Data)
library(readxl)
data <- read_excel("Data/totalR.xlsx")
names(Data)
totalR.xlsx
names(data)
GLM5<-glm(STX ~ Area+Season+Organism,family="Gamma",data= data,na.action=na.fail)
GLM5<-glm(STX ~ Area+season+Organism,family="Gamma",data= data,na.action=na.fail)
GLM5<-glm(STX ~ Area+season+Organism,family="Gamma"(link="log"),data= data,na.action=na.fail)
GLM5<-glm(log(STX + 1) ~ Area+season+Organism,family="Gamma",data= data,na.action=na.fail)
View(data)
GLM5<-glm(log(STX + 1) ~ Area+season+Organism,family="Gamma",data= data,na.action=na.fail)
GLM5<-glm(log(STX + 1) ~ Area+season+Organism,family="Gamma"(link="log"),data= data,na.action=na.fail)
data <- read_excel("Data/totalRSTXpositiva.xlsx")
data <- read_excel("Data/totalRSTXpositiva.xlsx")
data <- read_excel("Data/totalR-STXpositiva.xlsx")
names(data)
GLM5<-glm (STX  ~ Area+season+Organism,family="Gamma"(link="log"),data= data,na.action=na.fail)
summary(GLM5)
lybrary(mgdvc)
library(mgdvc)
library(mgvdc)
library(mgcv)
gam(STX  ~ Area+season+Organism,family="Gamma"(link="log"),data= data,na.action=na.fail))
gam(STX  ~ s(Area)+ s(season) + s(Organism),family="Gamma"(link="log"),data= data,na.action=na.fail))
gam-model1 <- gam (STX  ~ Area + season + Organism,family="Gamma"(link="log"), data= data, method = "REML)
gam-model1
plot(gam-model1)
library(mgcv)
gam-model1 <- gam (STX  ~ Area + season + Organism,family="Gamma"(link="log"), data= data, method = "REML)
library(mgcv)
gam-model1 <- gam (STX  ~ Area + season + Organism,family="Gamma"(link="log"), data= data, method = "REML)
plot(gam-model1)
plot.gam(gam-model1)
GLM5<-glm (STX  ~ Area+season+Organism,family="Gamma"(link="log"),data= data,na.action=na.fail)
data <- read_excel("Data/totalR-STXpositiva.xlsx")
names(data)
GLM5<-glm (STX  ~ Area+season+Organism,family="Gamma"(link="log"),data= data,na.action=na.fail)
summary(GLM5)
GLM5<-glm (STX  ~ Area+season+Organism,family="Gamma"(link="log"),data= data,na.action=na.fail)
summary(GLM5)
